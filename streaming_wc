Socket Streaming:
One Terminal: nc -lk 8476
Other Terminal:
pyspark --master local --conf "spark.sql.shuffle.partitions=2"
from pyspark.sql import split, explode

host="localhost"
port=8476

lines = spark.readStream.format("socket").option("host",host).option("port",port).load()

words = lines.select(explode(split(value, " ")).alias("word"))

wordsCount = words.groupBy("word").count()

query = wordsCount.writeStream.outputMode("complete").format("console").start()

